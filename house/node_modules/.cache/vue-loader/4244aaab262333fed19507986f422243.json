{"remainingRequest":"D:\\html_repo\\house\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\html_repo\\house\\page\\role\\detail.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\html_repo\\house\\page\\role\\detail.vue","mtime":1697106602349},{"path":"D:\\html_repo\\house\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1697106597071},{"path":"D:\\html_repo\\house\\node_modules\\babel-loader\\lib\\index.js","mtime":1697106596884},{"path":"D:\\html_repo\\house\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1697106597071},{"path":"D:\\html_repo\\house\\node_modules\\vue-loader\\lib\\index.js","mtime":1697106601613}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nexport default {\n\tdata: function() {\n\t\treturn {\n\t\t\trole: {\n\t\t\t\troleId: 0,\n\t\t\t\troleName: \"\",\n\t\t\t\tpermissions: [],\n\t\t\t},\n\t\t\tpermissions: [],\n\t\t\tallPermissions: []\n\t\t};\n\t},\n\tmethods: {\n\t\tsubmit: function() {\n\t\t\tlet self = this;\n\t\t\t\n\t\t\tthis.$data.permissions = [];\n\t\t\tfor (let index in this.$data.allPermissions) {\n\t\t\t\tlet permission = this.$data.allPermissions[index];\n\t\t\t\tif (permission.indeterminate || permission.checked) {\n\t\t\t\t\tthis.$data.permissions.push(permission.permissionId);\n\t\t\t\t\t\n\t\t\t\t\tfor (let jndex in permission.children) {\n\t\t\t\t\t\tlet subPermission = permission.children[jndex];\n\t\t\t\t\t\tif (subPermission.checked) {\n\t\t\t\t\t\t\tthis.$data.permissions.push(subPermission.permissionId);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\t\t\t\n\t\t\tif (this.$data.permissions.length === 0) {\n\t\t\t\tthis.message.error(\"请选择权限\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t\n\t\t\tif (this.$data.role.roleName.length === 0) {\n\t\t\t\tthis.message.error(\"请输入角色名\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tdelete self.$data.role.ct;\n\t\t\tdelete self.$data.role.ut;\n\t\t\tdelete self.$data.role.cu;\n\t\t\tdelete self.$data.role.uu;\n\t\t\tself.$data.role.permissions = JSON.stringify(self.$data.permissions);\n\t\t\tthis.http.put({\n\t\t\t\turl: \"/role/info\",\n\t\t\t\tparam: self.$data.role,\n\t\t\t}).then(data => {\n\t\t\t\tself.message.info(\"修改成功\");\n\t\t\t\tself.$tabs.close();\n\t\t\t});\n\t\t},\n\t\tcancel: function() {\n\t\t\tthis.$tabs.close();\n\t\t},\n\t\tinit: function() {\n\t\t\tthis.searchPermission();\n\t\t},\n\t\tsearchPermission: function() {\n\t\t\tlet self = this;\n\t\t\tthis.http.get({\n\t\t\t\turl: \"/role/info\",\n\t\t\t\tparam: {\n\t\t\t\t\troleId : self.$data.role.roleId\n\t\t\t\t}\n\t\t\t}).then(data => {\n\t\t\t\tconsole.log(data);\n\t\t\t\tself.$data.role = data.role;\n\t\t\t\tthis.$data.permissions = data.permissions ? data.permissions : [];\n\t\t\t\t\n\t\t\t}).then(() => {\n\t\t\t\tself.http.get({\n\t\t\t\t\turl: \"/permission/all\",\n\t\t\t\t}).then(data => {\n\t\t\t\t\tconsole.log(data);\n\t\t\t\t\tself.$data.allPermissions = [];\n\t\t\t\t\tfor (let index in data) {\n\t\t\t\t\t\tlet permission = {};\n\t\t\t\t\t\tpermission.title = data[index].name;\n\t\t\t\t\t\tpermission.expand = true;\n\t\t\t\t\t\tpermission.children = [];\n\t\t\t\t\t\tpermission.permissionId = data[index].permissionId;\n\t\t\t\t\t\t\n\t\t\t\t\t\tfor (let jndex in data[index].permissions) {\n\t\t\t\t\t\t\tlet subPermission = {};\n\t\t\t\t\t\t\tsubPermission.title = data[index].permissions[jndex].name;\n\t\t\t\t\t\t\tsubPermission.permissionId = data[index].permissions[jndex].permissionId;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif (self.$data.permissions.includes(data[index].permissions[jndex].permissionId)) {\n\t\t\t\t\t\t\t\tsubPermission.checked = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tpermission.children.push(subPermission);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tself.$data.allPermissions.push(permission);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t});\n\t\t}\n\t},\n\tcreated: function () {\n\t\tthis.$data.role.roleId = this.$route.params.roleId;\n\t\tconsole.log(this.$data.role.roleId);\n\t\tthis.init();\n\t},\n}\n",{"version":3,"sources":["detail.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAyBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"detail.vue","sourceRoot":"page/role","sourcesContent":["<template>\r\n\t<Layout class=\"p-5 bg-white\">\r\n\t\t<Form :label-width=\"80\">\r\n\t\t\t<FormItem class=\"w-50\" label=\"角色ID\">\r\n\t\t\t\t<label>{{role.roleId}}</label>\r\n\t\t\t</FormItem>\r\n\t\t\t<FormItem class=\"w-50\" label=\"角色名\">\r\n\t\t\t\t<Input v-model=\"role.roleName\" placeholder=\"请输入角色的名称\"></Input>\r\n\t\t\t</FormItem>\r\n\t\t\t<FormItem class=\"w-50\" label=\"状态\">\r\n\t\t\t\t<i-switch v-model=\"role.statu\"></i-switch>\r\n\t\t\t</FormItem>\r\n\t\t\t<FormItem class=\"w-50\" label=\"权限\">\r\n\t\t\t\t<Tree \r\n\t\t\t\t\t:data=\"allPermissions\" show-checkbox multiple></Tree>\r\n\t\t\t</FormItem>\r\n\t\t\t<FormItem class=\"text-right\">\r\n\t\t\t\t<Button @click=\"submit\" type=\"primary\">提交</Button>\r\n\t\t\t\t<Button @click=\"cancel\" class=\"ml-2\">取消</Button>\r\n\t\t\t</FormItem>\r\n\t\t</Form>\r\n\t</Layout>\r\n</template>\r\n\r\n<script>\r\n\texport default {\r\n\t\tdata: function() {\r\n\t\t\treturn {\r\n\t\t\t\trole: {\r\n\t\t\t\t\troleId: 0,\r\n\t\t\t\t\troleName: \"\",\r\n\t\t\t\t\tpermissions: [],\r\n\t\t\t\t},\r\n\t\t\t\tpermissions: [],\r\n\t\t\t\tallPermissions: []\r\n\t\t\t};\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tsubmit: function() {\r\n\t\t\t\tlet self = this;\r\n\t\t\t\t\r\n\t\t\t\tthis.$data.permissions = [];\r\n\t\t\t\tfor (let index in this.$data.allPermissions) {\r\n\t\t\t\t\tlet permission = this.$data.allPermissions[index];\r\n\t\t\t\t\tif (permission.indeterminate || permission.checked) {\r\n\t\t\t\t\t\tthis.$data.permissions.push(permission.permissionId);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tfor (let jndex in permission.children) {\r\n\t\t\t\t\t\t\tlet subPermission = permission.children[jndex];\r\n\t\t\t\t\t\t\tif (subPermission.checked) {\r\n\t\t\t\t\t\t\t\tthis.$data.permissions.push(subPermission.permissionId);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\tif (this.$data.permissions.length === 0) {\r\n\t\t\t\t\tthis.message.error(\"请选择权限\");\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif (this.$data.role.roleName.length === 0) {\r\n\t\t\t\t\tthis.message.error(\"请输入角色名\");\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tdelete self.$data.role.ct;\r\n\t\t\t\tdelete self.$data.role.ut;\r\n\t\t\t\tdelete self.$data.role.cu;\r\n\t\t\t\tdelete self.$data.role.uu;\r\n\t\t\t\tself.$data.role.permissions = JSON.stringify(self.$data.permissions);\r\n\t\t\t\tthis.http.put({\r\n\t\t\t\t\turl: \"/role/info\",\r\n\t\t\t\t\tparam: self.$data.role,\r\n\t\t\t\t}).then(data => {\r\n\t\t\t\t\tself.message.info(\"修改成功\");\r\n\t\t\t\t\tself.$tabs.close();\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tcancel: function() {\r\n\t\t\t\tthis.$tabs.close();\r\n\t\t\t},\r\n\t\t\tinit: function() {\r\n\t\t\t\tthis.searchPermission();\r\n\t\t\t},\r\n\t\t\tsearchPermission: function() {\r\n\t\t\t\tlet self = this;\r\n\t\t\t\tthis.http.get({\r\n\t\t\t\t\turl: \"/role/info\",\r\n\t\t\t\t\tparam: {\r\n\t\t\t\t\t\troleId : self.$data.role.roleId\r\n\t\t\t\t\t}\r\n\t\t\t\t}).then(data => {\r\n\t\t\t\t\tconsole.log(data);\r\n\t\t\t\t\tself.$data.role = data.role;\r\n\t\t\t\t\tthis.$data.permissions = data.permissions ? data.permissions : [];\r\n\t\t\t\t\t\r\n\t\t\t\t}).then(() => {\r\n\t\t\t\t\tself.http.get({\r\n\t\t\t\t\t\turl: \"/permission/all\",\r\n\t\t\t\t\t}).then(data => {\r\n\t\t\t\t\t\tconsole.log(data);\r\n\t\t\t\t\t\tself.$data.allPermissions = [];\r\n\t\t\t\t\t\tfor (let index in data) {\r\n\t\t\t\t\t\t\tlet permission = {};\r\n\t\t\t\t\t\t\tpermission.title = data[index].name;\r\n\t\t\t\t\t\t\tpermission.expand = true;\r\n\t\t\t\t\t\t\tpermission.children = [];\r\n\t\t\t\t\t\t\tpermission.permissionId = data[index].permissionId;\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tfor (let jndex in data[index].permissions) {\r\n\t\t\t\t\t\t\t\tlet subPermission = {};\r\n\t\t\t\t\t\t\t\tsubPermission.title = data[index].permissions[jndex].name;\r\n\t\t\t\t\t\t\t\tsubPermission.permissionId = data[index].permissions[jndex].permissionId;\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tif (self.$data.permissions.includes(data[index].permissions[jndex].permissionId)) {\r\n\t\t\t\t\t\t\t\t\tsubPermission.checked = true;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tpermission.children.push(subPermission);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tself.$data.allPermissions.push(permission);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\t\tcreated: function () {\r\n\t\t\tthis.$data.role.roleId = this.$route.params.roleId;\r\n\t\t\tconsole.log(this.$data.role.roleId);\r\n\t\t\tthis.init();\r\n\t\t},\r\n\t}\r\n</script>\r\n\r\n<style>\r\n</style>\r\n"]}]}